#:import MDLabel kivymd.uix.label.MDLabel
#:import MDButton kivymd.uix.button.MDRaisedButton
ScreenManager:
    id:skreenManager
    name:skreenManager
    LoginScreen:
    RegisterScreen:
    MainScreen:
    ChatScreen:



<RegisterScreen>:
    name: "Register"
    id: RegisterScreen
    namee: namee
    email: email
    password: passw

    FloatLayout:
        cols:1

        FloatLayout:
            size: root.width, root.height/2

            Label:
                id:created
                text: "Create an Account"
                size_hint: 0.8, 0.2
                pos_hint: {"x":0.1, "top":1}
                font_size: (root.width**2 + root.height**2) / 14**4

            Label:
                id: namee_label
                size_hint: 0.5,0.12
                pos_hint: {"x":0, "top":0.8}
                text: "Name: "
                font_size: (root.width**2 + root.height**2) / 14**4

            TextInput:
                pos_hint: {"x":0.5, "top":0.8}
                size_hint: 0.4, 0.12
                id: namee
                multiline: False
                font_size: (root.width**2 + root.height**2) / 14**4

            Label:
                id: email_label
                size_hint: 0.5,0.12
                pos_hint: {"x":0, "top":0.8-0.13}
                text: "Email: "
                font_size: (root.width**2 + root.height**2) / 14**4

            TextInput:
                pos_hint: {"x":0.5, "top":0.8-0.13}
                size_hint: 0.4, 0.12
                id: email
                multiline: False
                font_size: (root.width**2 + root.height**2) / 14**4

            Label:
                id: password_label
                size_hint: 0.5,0.12
                pos_hint: {"x":0, "top":0.8-0.13*2}
                text: "Password: "
                font_size: (root.width**2 + root.height**2) / 14**4

            TextInput:
                pos_hint: {"x":0.5, "top":0.8-0.13*2}
                size_hint: 0.4, 0.12
                id: passw
                multiline: False
                password: True
                font_size: (root.width**2 + root.height**2) / 14**4

        Button:
            id:relogin
            pos_hint:{"x":0.3,"y":0.25}
            size_hint: 0.4, 0.1
            font_size: (root.width**2 + root.height**2) / 17**4
            text: "Already have an Account? Log In"
            on_release:
                root.manager.transition.direction = "left"
                root.login()

        Button:
            id: submit
            pos_hint:{"x":0.2,"y":0.05}
            size_hint: 0.6, 0.15
            text: "Submit"
            font_size: (root.width**2 + root.height**2) / 14**4
            on_release:
                root.manager.transition.direction = "left"
                root.submit()


<LoginScreen>:
    name: "Login"
    id: LoginScreen
    email: email
    password: password
    space_x: self.size[0]/3
    bg: .30, .23, .43,0.2
    MDFloatLayout:
        size_hint:(None,None)
        size:(480,480)
        pos_hint: {"center_x":.5, "center_y":.5}

        canvas:
            Color:
                rgba:app.theme_cls.bg_darkest
            Rectangle:
                pos:self.pos
                size:self.size
        MDFloatLayout:
            size_hint: .32,.2
            pos_hint: {"center_x":.5, "center_y":.86}
            canvas.after:
                Color:
                    rgb:(1,1,1,1)
                RoundedRectangle:
                    pos:(self.pos[0]+(self.size[0]-self.size[1])/2, self.pos[1]+dp(7))
                    size:(self.size[1]-dp(14), self.size[1]-dp(14))
                    radius: [self.size[1]-(self.size[1]/2)]
                    source:"user.webp"

        MDLabel:
            id:login_label
            text:"LogIn"
            halign:"center"
            pos_hint: {"center_y":.68}
            font_style: "H4"
            bold:True
            theme_text_color: 'Custom'
            text_color: (1,1,1,1)



        MDFloatLayout:
            size_hint:.9,.12
            pos_hint:{"center_x":.5, "center_y":.53}
            canvas:
                Color:
                    rgb:(224/255,224/255,224/255,1)
                Rectangle:
                    size: self.size
                    pos:self.pos


            MDTextField:
                id: email
                multiline: False
                focus:True
                hint_text: "Email"
                current_hint_text_color:0,0,0,1
                pos_hint:{"center_x":.5, "center_y":.385}
                size_hint: .92,1
                on_text_validate:password.focus=True

        MDFloatLayout:
            size_hint:.9,.12
            pos_hint:{"center_x":.5, "center_y":.35}
            canvas:
                Color:
                    rgb:(224/255,224/255,224/255,1)
                Rectangle:
                    size: self.size
                    pos:self.pos
            MDTextField:
                id: password
                multiline: False
                password: True
                pos_hint:{"center_x":.5, "center_y":.385}
                size_hint: .92,1
                hint_text:"Password"
                current_hint_text_color:0,0,0,1

        MDRectangleFlatButton:
            text: "Submit"
            size_hint:.6,.09
            pos_hint:{"center_x": .5, "center_y":.18}
            background_color:(.30,.23,.43,0.2)
            background_normal:''

            on_release:
                root.manager.transition.direction = "up"
                root.loginBtn()
        Button:
            size_hint:.6,.09
            pos_hint:{"center_x": .5, "center_y":.06}
            text: "Don't have an Account? register"
            on_release:
                root.manager.transition.direction = "right"
                root.registerBtn()


<MainScreen>:
    id:MainScreen
    name:"Main"
    nas: nas
    email: email
    created:created

    FloatLayout:
        size_hint: (None,None)
        height: 0.9*root.height
        width: root.width
        MDLabel:
            id: nas
            pos_hint:{"x": 0.1, "top":0.9}
            size_hint:0.8, 0.2
            text: "Account Name: "

        MDLabel:
            id: email
            pos_hint:{"x": 0.1, "top":0.7}
            size_hint:0.8, 0.2
            text: "Email: "

        MDLabel:
            id: created
            pos_hint:{"x": 0.1, "top":0.5}
            size_hint:0.8, 0.2
            text: "Created: "


    MDBottomNavigation:

        size_hint: (None,None)
        height: root.height*0.1
        width: root.width
        spacing: 0
        MDBottomNavigationItem:
            id: gochat_button
            icon:"chat"
            text: "Chat"
            on_tab_release:
                app.root.current = "Chat"
                root.manager.transition.direction = "down"

        MDBottomNavigationItem:
            id: logout_button
            icon:"account"
            text: "Log Out"
            on_tab_release:
                app.root.current = "Login"
                root.manager.transition.direction = "down"

        MDBottomNavigationItem:
            id: logout_button
            icon:"settings"
            text: "settings"
            on_tab_release:
                app.root.current = "Login"
                root.manager.transition.direction = "down"
        MDBottomNavigationItem:
            id: logout_button
            icon:"contacts"
            text: "contacts"
            on_tab_release:
                app.root.current = "Login"
                root.manager.transition.direction = "down"


<ChatScreen>
    name: "Chat"
    id:ChatScreen
    messages: messages

    to_send: to_send


    GridLayout:
        cols:1
        rows:2

        ScrollView:
            size: root.width, root.height*0.9
            canvas.before:
                Color:
                    rgba:(.30,.23,.43,0.2)
                Rectangle:
                    pos:self.pos
                    size:self.size
            Label:

                id: messages
                text: "messages"
                font_size: (root.width**2 + root.height**2) / 14**4
                markup:True

        GridLayout:
            cols:2
            size_hint: (None, None)
            height:root.height*0.1
            width:root.width


            TextInput:
                id:to_send
                name: to_send
                size_hint: (None, None)
                hint_text: "type..."
                width: root.width*0.8

                multiline: True



            MDIconButton:
                id: send_button

                icon:'send'
                user_font_size: "75sp"
                halign: 'center'
                valign: 'top'
                theme_text_color: "Custom"
                text_color: app.theme_cls.primary_color

                on_release:
                    root.manager.transition.direction = "up"
                    root.sendBtn()